# Example ESRS Report Template

This document describes the structure and content of ESRS-aligned reports generated by the CSRD engine, aligned with **ESRS (European Sustainability Reporting Standards)** requirements.

---

## Report Structure

The CSRD engine generates reports in the following structure, aligned with ESRS standards:

```json
{
  "metadata": {...},
  "executive_summary": {...},
  "materiality_assessment": {...},
  "emission_calculations": {...},
  "data_integrity": {...},
  "compliance_summary": {...},
  "assumptions": [...]
}
```

---

## 1. Metadata

**Purpose:** Provides report identification and versioning information.

**Fields:**
- `report_id`: Unique identifier for the report (deterministic, UUIDv5)
- `dataset_version_id`: DatasetVersion ID this report is bound to (immutable anchor)
- `generated_at`: ISO 8601 timestamp of report generation
- `standard`: Reporting standard identifier ("ESRS")
- `version`: Report structure version ("v0-skeleton")

**Example:**
```json
{
  "metadata": {
    "report_id": "018f1234-5678-90ab-cdef-1234567890ab",
    "dataset_version_id": "018f1234-5678-90ab-cdef-0987654321ba",
    "generated_at": "2025-01-15T10:30:00+00:00",
    "standard": "ESRS",
    "version": "v0-skeleton"
  }
}
```

**ESRS Alignment:** Provides traceability and version control per ESRS 1 (General Requirements).

---

## 2. Executive Summary

**Purpose:** Provides a high-level overview of ESG performance, highlighting key achievements and challenges.

**Fields:**
- `high_level`: Brief narrative overview
- `material_topics_count`: Number of material topics identified
- `total_emissions_tco2e`: Total greenhouse gas emissions across all scopes

**Example:**
```json
{
  "executive_summary": {
    "high_level": "Double materiality assessment and emissions summary produced from ingested datasets.",
    "material_topics_count": 3,
    "total_emissions_tco2e": 8000.0
  }
}
```

**ESRS Alignment:** ESRS 1 requires executive-level disclosure of material sustainability matters.

---

## 3. Materiality Assessment

**Purpose:** Summarizes the most significant ESG risks and their potential financial impacts. Documents the process and criteria used for materiality determination.

**Fields:**
- `methodology`: Description of the materiality assessment methodology
- `material_topics`: List of material topics with materiality determination
- `findings`: Detailed findings for each assessed topic

**Material Topics Structure:**
```json
{
  "id": "topic_identifier",
  "is_material": true
}
```

**Findings Structure:**
Each finding includes:
- `id`: Deterministic finding identifier
- `dataset_version_id`: DatasetVersion binding
- `title`: Human-readable title
- `category`: Category (emissions, governance, opportunity)
- `metric`: Specific metric name
- `description`: Description of the finding
- `value`: Actual value
- `threshold`: Threshold for materiality determination
- `is_material`: Boolean materiality determination
- `materiality`: String representation ("material" or "not_material")
- `financial_impact_eur`: Estimated financial impact in EUR
- `impact_score`: Impact score (0.0 to 1.0)
- `confidence`: Confidence level (low, medium, high)

**Example:**
```json
{
  "materiality_assessment": {
    "methodology": "Double materiality (financial + impact) with configurable thresholds.",
    "material_topics": [
      {"id": "total_emissions_tco2e", "is_material": true},
      {"id": "board_diversity", "is_material": true},
      {"id": "esg_governance", "is_material": false}
    ],
    "findings": [
      {
        "id": "018f1234-...",
        "dataset_version_id": "018f1234-...",
        "title": "emissions: total_emissions_tco2e",
        "category": "emissions",
        "metric": "total_emissions_tco2e",
        "description": "Total operational and value chain emissions.",
        "value": 8000.0,
        "threshold": 5000.0,
        "is_material": true,
        "materiality": "material",
        "financial_impact_eur": 800000.0,
        "impact_score": 1.0,
        "confidence": "medium"
      },
      ...
    ]
  }
}
```

**ESRS Alignment:** 
- ESRS 1 requires double materiality assessment (financial materiality + impact materiality)
- ESRS 2 requires disclosure of material topics and their assessment process
- Material topics must be disclosed with clear methodology and financial impact estimates

---

## 4. Emission Calculations

**Purpose:** Detailed greenhouse gas emissions calculations following GHG Protocol standards.

**Fields:**
- `dataset_version_id`: DatasetVersion binding
- `scopes`: Scope 1, 2, and 3 emission details
- `total_emissions_tco2e`: Total emissions across all scopes

**Scope Structure:**
Each scope (scope1, scope2, scope3) includes:
- `value`: Emission value in tCO2e
- `unit`: Unit (always "tCO2e")
- `source`: Data source (e.g., "reported_or_default", "IEA 2023")
- `methodology`: Calculation methodology (direct, market-based/location-based, value_chain)

**Example:**
```json
{
  "emission_calculations": {
    "dataset_version_id": "018f1234-...",
    "scopes": {
      "scope1": {
        "value": 1000.0,
        "unit": "tCO2e",
        "source": "reported_or_default",
        "methodology": "direct"
      },
      "scope2": {
        "value": 2000.0,
        "unit": "tCO2e",
        "source": "reported_or_default",
        "methodology": "market-based"
      },
      "scope3": {
        "value": 5000.0,
        "unit": "tCO2e",
        "source": "reported_or_default",
        "methodology": "value_chain"
      }
    },
    "total_emissions_tco2e": 8000.0
  }
}
```

**ESRS Alignment:**
- ESRS E1 (Climate Change) requires disclosure of Scope 1, 2, and 3 emissions
- Methodology must be clearly stated (e.g., market-based vs. location-based for Scope 2)
- Sources must be documented for transparency

---

## 5. Data Integrity

**Purpose:** Documents data integrity, immutability, and traceability measures.

**Fields:**
- `dataset_version_id`: DatasetVersion ID that anchors all data
- `immutability`: Statement about data immutability
- `traceability`: Statement about traceability to source records
- `limitations`: Known limitations affecting data quality or completeness
- `warnings`: List of warnings (e.g., missing data, incomplete inputs)

**Example:**
```json
{
  "data_integrity": {
    "dataset_version_id": "018f1234-...",
    "immutability": "Anchored to DatasetVersion; core records are write-once.",
    "traceability": "Findings are linked to source RawRecords and EvidenceRecords.",
    "limitations": "Input completeness and factor selection affect results.",
    "warnings": []
  }
}
```

**ESRS Alignment:**
- ESRS 1 requires disclosure of data quality and limitations
- ESRS 1 requires traceability and verification of data sources
- Immutability ensures audit-readiness and regulatory compliance

---

## 6. Compliance Summary

**Purpose:** Final review of ESRS-compliant data and disclosures, confirming framework alignment.

**Fields:**
- `framework`: Framework identifier ("ESRS-aligned structure (skeleton)")
- `sections_present`: List of report sections present
- `disclosures`: Additional disclosures (configurable via parameters)

**Example:**
```json
{
  "compliance_summary": {
    "framework": "ESRS-aligned structure (skeleton)",
    "sections_present": [
      "executive_summary",
      "materiality_assessment",
      "data_integrity",
      "compliance_summary",
      "emission_calculations"
    ],
    "disclosures": []
  }
}
```

**ESRS Alignment:**
- ESRS 1 requires confirmation of framework compliance
- All required sections must be present and documented

---

## 7. Assumptions

**Purpose:** Explicit documentation of all assumptions used in materiality assessment and emission calculations.

**Fields (per assumption):**
- `id`: Unique assumption identifier
- `description`: Clear description of the assumption
- `source`: Source of the assumption (config parameter, engine convention, external source)
- `impact`: How the assumption affects the results
- `sensitivity`: Sensitivity analysis (High/Medium/Low and explanation)

**Example:**
```json
{
  "assumptions": [
    {
      "id": "assumption_carbon_price",
      "description": "Carbon price used to translate emissions into financial exposure.",
      "source": "Config parameter carbon_price_eur_per_tco2e (default 100 EUR/tCO2e)",
      "impact": "Directly affects estimated financial exposure for emissions.",
      "sensitivity": "High - linear with carbon price."
    },
    {
      "id": "assumption_units",
      "description": "Emissions are expressed as metric tons CO2e (tCO2e).",
      "source": "Engine convention",
      "impact": "Ensures consistent aggregation across scopes.",
      "sensitivity": "Low - unit conversion is deterministic."
    },
    {
      "id": "assumption_default_factors",
      "description": "Default emission factors used when not provided.",
      "source": "Config defaults (2.68 kgCO2e/L fuel; 0.25 kgCO2e/kWh electricity)",
      "impact": "Affects calculated emissions when activity data is used.",
      "sensitivity": "High - linear with factor selection."
    }
  ]
}
```

**ESRS Alignment:**
- ESRS 1 requires explicit disclosure of assumptions and methodologies
- Assumptions must be traceable to their sources
- Sensitivity analysis is required for material assumptions

---

## Traceability and Evidence

All report content is backed by evidence records in the database:

- **Report Evidence:** Complete report stored in `evidence_records` with kind="report"
- **Emissions Evidence:** Emission calculations stored in `evidence_records` with kind="emissions"
- **Finding Evidence:** Each material finding has evidence in `evidence_records` with kind="finding"

**Traceability Chain:**
```
DatasetVersion (immutable anchor)
  └── RawRecord (source data)
       └── FindingRecord (materiality finding)
            └── FindingEvidenceLink
                 └── EvidenceRecord (evidence with assumptions, source, emissions link)
```

**Querying Evidence:**
```sql
-- Find all evidence for a DatasetVersion
SELECT * FROM evidence_records WHERE dataset_version_id = '...';

-- Find all findings for a DatasetVersion
SELECT * FROM finding_record WHERE dataset_version_id = '...';

-- Find evidence linked to a finding
SELECT e.* FROM evidence_records e
JOIN finding_evidence_link l ON e.evidence_id = l.evidence_id
JOIN finding_record f ON l.finding_id = f.finding_id
WHERE f.dataset_version_id = '...';
```

---

## ESRS Standards Compliance

This report structure aligns with:

- **ESRS 1 - General Requirements:** Overall structure, metadata, assumptions, data quality
- **ESRS 2 - General Disclosures:** Materiality assessment, governance disclosures
- **ESRS E1 - Climate Change:** Emission calculations, Scope 1/2/3 disclosures

**Future Enhancements:**
- Additional ESRS E-topics (pollution, water, biodiversity)
- Additional ESRS S-topics (own workforce, workers in value chain, affected communities, consumers)
- Additional ESRS G-topics (business conduct)
- Sector-specific disclosures (ESRS sector standards)

---

**Last Updated:** 2025-01-XX  
**Engine Version:** CSRD Engine v1  
**Report Version:** v0-skeleton  
**ESRS Alignment:** ESRS 1, ESRS 2, ESRS E1
